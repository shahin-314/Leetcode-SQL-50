
---

### Query

```sql
SELECT w1.id
FROM Weather w1
JOIN Weather w2
  ON DATEDIFF(w1.recordDate, w2.recordDate) = 1
WHERE w1.temperature > w2.temperature;
```

---

### Table (Weather)

```
+----+------------+-------------+
| id | recordDate | temperature |
+----+------------+-------------+
| 1  | 2015-01-01 | 10          |
| 2  | 2015-01-02 | 25          |
| 3  | 2015-01-03 | 20          |
| 4  | 2015-01-04 | 30          |
+----+------------+-------------+
```

---

### Step 1: Alias (w1 and w2)

* `Weather w1` â†’ ek copy of table (soch le ki ek dusra naam de diya hai `w1`).
* `Weather w2` â†’ same table ka second copy (ye hai `w2`).

ðŸ‘‰ Matlab hum **table ko apne aap se compare kar rahe hain** (Self Join).
Kyuki hume har row ka **previous day** dhoondhna hai.

---

### Step 2: `ON DATEDIFF(w1.recordDate, w2.recordDate) = 1`

* `DATEDIFF(date1, date2)` â†’ dono dates ka **difference in days** nikalta hai.

Ab dekh:

| w1.recordDate | w2.recordDate | DATEDIFF(w1,w2) |
| ------------- | ------------- | --------------- |
| 2015-01-02    | 2015-01-01    | 1               |
| 2015-01-03    | 2015-01-02    | 1               |
| 2015-01-04    | 2015-01-03    | 1               |

ðŸ‘‰ Sirf jab difference **1 day** hoga, tab join ho jaayega.
So `ON DATEDIFF(...) = 1` ka matlab hai:
**w1 = aaj ki row, w2 = kal ki row**

---

### Step 3: `WHERE w1.temperature > w2.temperature`

Ab hum check karte hain ki **aaj ka temp (`w1`) > kal ka temp (`w2`)** hai ya nahi.

---

### Step 4: Evaluate row by row

1. **w1 = 2015-01-02 (25)**

   * w2 = 2015-01-01 (10) â†’ DATEDIFF = 1 âœ”
   * Condition: 25 > 10 âœ”
     â†’ **id = 2 selected**

---

2. **w1 = 2015-01-03 (20)**

   * w2 = 2015-01-02 (25) â†’ DATEDIFF = 1 âœ”
   * Condition: 20 > 25 âŒ
     â†’ not selected

---

3. **w1 = 2015-01-04 (30)**

   * w2 = 2015-01-03 (20) â†’ DATEDIFF = 1 âœ”
   * Condition: 30 > 20 âœ”
     â†’ **id = 4 selected**

---

### âœ… Final Output

```
+----+
| id |
+----+
| 2  |
| 4  |
+----+
```

---

### âš¡ Short Summary (easy language)

* Hum table ko khud se join kar rahe hain (`self join`).
* `DATEDIFF = 1` â†’ aaj aur kal wali row ka pair banata hai.
* `WHERE` â†’ sirf un pairs ko leta hai jaha aaj ka temp kal se zyada hai.
* Aur finally, hum **w1 ka id** print kar dete hain (kyuki w1 = aaj ka din hai).

---

ðŸ‘‰ Bhai ab bata, main ek aur example (extra values ke saath) banaun taaki aur crystal clear ho jaaye?
